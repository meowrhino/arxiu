/* ============================================================
   RESET
   ============================================================ */
*, *::before, *::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

/* ============================================================
   VARIABLES DE TEMA
   Dos temas: normal (claro, windows-7-ish) y +18 (oscuro, amarillo).
   Todo el cambio de tema se hace cambiando la clase del <body>.
   ============================================================ */
:root {
  /* --- fondo de puntos --- */
  --bg:               #e5e5f7;
  --bg-dot:           #444cf7;
  --bg-dot-size:      1.05px;
  --bg-dot-gap:       21px;
  --bg-opacity:       0.8;

  /* --- ventana principal --- */
  --win-bg:           #f0eff5;
  --win-border:       #9896b8;
  --win-shadow:       0 4px 24px rgba(68,76,247,0.18), 0 1px 4px rgba(0,0,0,0.10);
  --win-radius:       6px;

  /* --- titlebar de ventana --- */
  --tb-bg:            #d4d0e8;
  --tb-border:        #9896b8;
  --tb-text:          #2a2840;
  --tb-sub:           #7a78a0;

  /* --- toolbar (barra de hashtags) --- */
  --tool-bg:          #e8e6f4;
  --tool-border:      #c0bedd;

  /* --- statusbar --- */
  --status-bg:        #e0deee;
  --status-border:    #c0bedd;
  --status-text:      #6a6888;

  /* --- grid de archivos --- */
  --content-bg:       #f8f7fc;

  /* --- iconos de archivo --- */
  --icon-doc-body:    #ffffff;
  --icon-doc-fold:    #d0cee8;
  --icon-doc-border:  #b0aec8;
  --icon-doc-text:    #444cf7;
  --icon-folder-body: #f0c040;
  --icon-folder-dark: #c89820;
  --icon-label:       #1a1830;
  --icon-label-sub:   #6a6888;

  /* --- tags --- */
  --tag-bg:           #e0deee;
  --tag-border:       #b0aec8;
  --tag-text:         #444cf7;
  --tag-bg-active:    #444cf7;
  --tag-text-active:  #ffffff;

  /* --- botones --- */
  --btn-primary-bg:   #444cf7;
  --btn-primary-fg:   #ffffff;
  --btn-secondary-bg: #e0deee;
  --btn-secondary-fg: #2a2840;
  --btn-border:       #9896b8;

  /* --- modal --- */
  --modal-bg:         #f0eff5;
  --modal-border:     #9896b8;
  --modal-overlay:    rgba(30, 28, 60, 0.45);
  --modal-tb-bg:      #d4d0e8;

  /* --- inputs --- */
  --input-bg:         #ffffff;
  --input-border:     #b0aec8;
  --input-focus:      #444cf7;

  /* --- progress --- */
  --progress-bg:      #d0cee8;
  --progress-fill:    #444cf7;

  /* --- texto --- */
  --text-primary:     #1a1830;
  --text-secondary:   #4a4868;
  --text-muted:       #8886a8;

  /* --- velo +18 --- */
  --veil-bg:          rgba(20, 18, 48, 0.82);
  --veil-box-bg:      #f0eff5;
  --veil-box-border:  #9896b8;

  /* --- fuentes --- */
  --font:             system-ui, -apple-system, "Segoe UI", Helvetica, Arial, sans-serif;
  --font-mono:        "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

  /* --- dots de la titlebar --- */
  --dot-red:    #ff5f57;
  --dot-yellow: #ffbd2e;
  --dot-green:  #28c840;
}

/* --- TEMA +18: oscuro, amarillo --- */
body.mode-18 {
  --bg:               #0f0d00;
  --bg-dot:           #f5c400;
  --bg-opacity:       0.65;

  --win-bg:           #1a1700;
  --win-border:       #4a4200;
  --win-shadow:       0 4px 24px rgba(245,196,0,0.18), 0 1px 4px rgba(0,0,0,0.4);

  --tb-bg:            #2a2500;
  --tb-border:        #4a4200;
  --tb-text:          #f5e87a;
  --tb-sub:           #a09020;

  --tool-bg:          #221e00;
  --tool-border:      #3a3400;

  --status-bg:        #1e1a00;
  --status-border:    #3a3400;
  --status-text:      #8a7e20;

  --content-bg:       #1a1700;

  --icon-doc-body:    #2a2500;
  --icon-doc-fold:    #3a3200;
  --icon-doc-border:  #5a5000;
  --icon-doc-text:    #f5c400;
  --icon-folder-body: #f5c400;
  --icon-folder-dark: #c89820;
  --icon-label:       #f5e87a;
  --icon-label-sub:   #8a7e20;

  --tag-bg:           #2a2500;
  --tag-border:       #4a4200;
  --tag-text:         #f5c400;
  --tag-bg-active:    #f5c400;
  --tag-text-active:  #0f0d00;

  --btn-primary-bg:   #f5c400;
  --btn-primary-fg:   #0f0d00;
  --btn-secondary-bg: #2a2500;
  --btn-secondary-fg: #f5e87a;
  --btn-border:       #4a4200;

  --modal-bg:         #1a1700;
  --modal-border:     #4a4200;
  --modal-overlay:    rgba(0, 0, 0, 0.72);
  --modal-tb-bg:      #2a2500;

  --input-bg:         #2a2500;
  --input-border:     #4a4200;
  --input-focus:      #f5c400;

  --progress-bg:      #3a3200;
  --progress-fill:    #f5c400;

  --text-primary:     #f5e87a;
  --text-secondary:   #c9b830;
  --text-muted:       #7a6e20;

  --veil-bg:          rgba(0, 0, 0, 0.88);
  --veil-box-bg:      #1a1700;
  --veil-box-border:  #4a4200;

  --dot-red:    #ff5f57;
  --dot-yellow: #ffbd2e;
  --dot-green:  #28c840;
}


/* ============================================================
   BODY: fondo de puntos
   ============================================================ */
body {
  font-family:    var(--font);
  font-size:      14px;
  line-height:    1.5;
  color:          var(--text-primary);
  min-height:     100dvh;
  display:        flex;
  align-items:    center;
  justify-content: center;
  padding:        2rem 1rem;

  /* fondo base */
  background-color: var(--bg);
  transition: background-color 0.4s ease, color 0.4s ease;
}

/* capa de puntos con opacity independiente del contenido */
body::before {
  content:    "";
  position:   fixed;
  inset:      0;
  z-index:    -1;
  background-image: radial-gradient(
    var(--bg-dot) var(--bg-dot-size),
    transparent   var(--bg-dot-size)
  );
  background-color: var(--bg);
  background-size:  var(--bg-dot-gap) var(--bg-dot-gap);
  opacity:    var(--bg-opacity);
  transition: background-color 0.4s ease, opacity 0.4s ease;
}


/* ============================================================
   VENTANA PRINCIPAL
   Imita la estética de una ventana del finder / explorador.
   ============================================================ */
#window-frame {
  width:          70dvw;
  max-width:      800px;
  min-width:      320px;
  background:     var(--win-bg);
  border:         1px solid var(--win-border);
  border-radius:  var(--win-radius);
  box-shadow:     var(--win-shadow);
  display:        flex;
  flex-direction: column;
  overflow:       hidden;
  transition:     background 0.4s, border-color 0.4s, box-shadow 0.4s;

  /* altura máxima: deja espacio al viewport */
  max-height:     88dvh;
}

/* --- titlebar --- */
#window-titlebar {
  background:     var(--tb-bg);
  border-bottom:  1px solid var(--tb-border);
  padding:        0.5rem 0.75rem;
  display:        flex;
  align-items:    center;
  gap:            0.6rem;
  flex-shrink:    0;
  user-select:    none;
  transition:     background 0.4s, border-color 0.4s;
}

#window-dots {
  display:  flex;
  gap:      5px;
  flex-shrink: 0;
}

.dot {
  width:         12px;
  height:        12px;
  border-radius: 50%;
  display:       inline-block;
}

.dot-red    { background: var(--dot-red); }
.dot-yellow { background: var(--dot-yellow); }
.dot-green  { background: var(--dot-green); }

#window-title {
  font-size:      0.82rem;
  font-weight:    600;
  color:          var(--tb-text);
  font-family:    var(--font-mono);
  letter-spacing: 0.04em;
}

#window-subtitle {
  font-size:      0.72rem;
  color:          var(--tb-sub);
  font-family:    var(--font-mono);
  margin-left:    auto;
}

/* --- toolbar de hashtags --- */
#window-toolbar {
  background:     var(--tool-bg);
  border-bottom:  1px solid var(--tool-border);
  padding:        0.45rem 0.75rem;
  flex-shrink:    0;
  transition:     background 0.4s, border-color 0.4s;
}

#hashtag-nav {
  display:    flex;
  flex-wrap:  wrap;
  gap:        0.3rem;
}

.tag-btn {
  font:           inherit;
  font-size:      0.72rem;
  font-family:    var(--font-mono);
  cursor:         pointer;
  background:     var(--tag-bg);
  color:          var(--tag-text);
  border:         1px solid var(--tag-border);
  padding:        0.15rem 0.5rem;
  border-radius:  2px;
  white-space:    nowrap;
  transition:     background 0.15s, color 0.15s, border-color 0.15s;
  /* efecto pixel: sin border-radius en modo pixel */
  image-rendering: pixelated;
}

.tag-btn:hover,
.tag-btn.active {
  background:   var(--tag-bg-active);
  color:        var(--tag-text-active);
  border-color: var(--tag-bg-active);
}

.tag-btn.all-btn {
  font-weight: 700;
}

/* --- área de contenido (grid de iconos) --- */
#window-content {
  flex:           1;
  overflow-y:     auto;
  background:     var(--content-bg);
  padding:        1rem;
  transition:     background 0.4s;
}

/* scrollbar discreta */
#window-content::-webkit-scrollbar { width: 6px; }
#window-content::-webkit-scrollbar-track { background: transparent; }
#window-content::-webkit-scrollbar-thumb {
  background: var(--tag-border);
  border-radius: 3px;
}

/* --- grid de iconos: imita el finder en vista de iconos --- */
#file-grid {
  display:                grid;
  grid-template-columns:  repeat(auto-fill, minmax(88px, 1fr));
  gap:                    0.5rem 0.25rem;
  align-items:            start;
}

/* mensaje vacío */
#empty-msg {
  grid-column:  1 / -1;
  text-align:   center;
  font-size:    0.8rem;
  font-family:  var(--font-mono);
  color:        var(--text-muted);
  padding:      2rem 0;
}

/* --- statusbar inferior --- */
#window-statusbar {
  background:     var(--status-bg);
  border-top:     1px solid var(--status-border);
  padding:        0.45rem 0.75rem;
  display:        flex;
  align-items:    center;
  justify-content: space-between;
  flex-shrink:    0;
  gap:            0.5rem;
  transition:     background 0.4s, border-color 0.4s;
}

#status-count {
  font-size:      0.72rem;
  font-family:    var(--font-mono);
  color:          var(--status-text);
}

#footer-buttons {
  display:  flex;
  gap:      0.4rem;
}


/* ============================================================
   TARJETA DE ARCHIVO (icono estilo finder)
   ============================================================ */
.file-card {
  display:        flex;
  flex-direction: column;
  align-items:    center;
  gap:            0.3rem;
  padding:        0.5rem 0.25rem 0.4rem;
  border-radius:  3px;
  cursor:         pointer;
  text-decoration: none;
  color:          inherit;
  border:         1px solid transparent;
  transition:     background 0.15s, border-color 0.15s;
}

.file-card:hover {
  background:   rgba(68, 76, 247, 0.08);
  border-color: rgba(68, 76, 247, 0.25);
}

body.mode-18 .file-card:hover {
  background:   rgba(245, 196, 0, 0.10);
  border-color: rgba(245, 196, 0, 0.30);
}

.file-card:focus-visible {
  outline: 2px solid var(--tag-bg-active);
  outline-offset: 2px;
}

/* icono SVG del documento: pixel-art */
.file-icon-wrap {
  width:            56px;
  height:           64px;
  display:          flex;
  align-items:      center;
  justify-content:  center;
  flex-shrink:      0;
}

.file-icon-wrap svg {
  width:  100%;
  height: 100%;
  image-rendering: pixelated;
  image-rendering: crisp-edges;
}

/* nombre del archivo */
.file-label {
  width:          100%;
  text-align:     center;
  font-size:      0.68rem;
  font-family:    var(--font-mono);
  color:          var(--icon-label);
  line-height:    1.3;
  word-break:     break-word;
  overflow-wrap:  break-word;
  /* máximo 2 líneas */
  display:        -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow:       hidden;
}

/* autor debajo del nombre */
.file-author {
  font-size:      0.62rem;
  font-family:    var(--font-mono);
  color:          var(--icon-label-sub);
  text-align:     center;
  width:          100%;
  white-space:    nowrap;
  overflow:       hidden;
  text-overflow:  ellipsis;
}

/* hashtags del archivo */
.file-tags {
  display:    flex;
  flex-wrap:  wrap;
  gap:        0.15rem;
  justify-content: center;
}

.file-tag {
  font-size:      0.58rem;
  font-family:    var(--font-mono);
  color:          var(--tag-text);
  background:     var(--tag-bg);
  border:         1px solid var(--tag-border);
  padding:        0.05rem 0.3rem;
  border-radius:  1px;
}


/* ============================================================
   BOTONES
   ============================================================ */
.btn-primary,
.btn-secondary {
  font:           inherit;
  font-size:      0.75rem;
  cursor:         pointer;
  padding:        0.35rem 0.85rem;
  border-radius:  2px;
  border:         1px solid var(--btn-border);
  transition:     background 0.15s, color 0.15s, border-color 0.15s, opacity 0.15s;
  white-space:    nowrap;
}

.btn-primary {
  background:   var(--btn-primary-bg);
  color:        var(--btn-primary-fg);
  border-color: var(--btn-primary-bg);
}

.btn-primary:hover  { opacity: 0.82; }
.btn-primary:active { opacity: 0.65; }

.btn-secondary {
  background:   var(--btn-secondary-bg);
  color:        var(--btn-secondary-fg);
}

.btn-secondary:hover {
  border-color: var(--btn-primary-bg);
  color:        var(--btn-primary-bg);
}

/* cuando el modo +18 está activo, el botón "soy mayor" se ve activado */
body.mode-18 #btn-18 {
  background:   var(--btn-primary-bg);
  color:        var(--btn-primary-fg);
  border-color: var(--btn-primary-bg);
}

.full-width { width: 100%; }


/* ============================================================
   MODAL DE SUBIDA
   ============================================================ */
#modal-overlay {
  position:   fixed;
  inset:      0;
  z-index:    200;
  background: var(--modal-overlay);
  backdrop-filter:         blur(4px);
  -webkit-backdrop-filter: blur(4px);
  transition: background 0.4s;
}

#modal-upload {
  position:   fixed;
  inset:      0;
  z-index:    210;
  display:    flex;
  align-items: center;
  justify-content: center;
  pointer-events: none;
}

#modal-upload:not([hidden]) {
  pointer-events: auto;
}

.modal-box {
  background:     var(--modal-bg);
  border:         1px solid var(--modal-border);
  border-radius:  var(--win-radius);
  width:          min(440px, 92dvw);
  box-shadow:     var(--win-shadow);
  overflow:       hidden;
  transition:     background 0.4s, border-color 0.4s;
}

/* titlebar del modal: mismo estilo que la ventana */
.modal-titlebar {
  background:     var(--modal-tb-bg);
  border-bottom:  1px solid var(--modal-border);
  padding:        0.45rem 0.75rem;
  display:        flex;
  align-items:    center;
  gap:            0.5rem;
  user-select:    none;
  transition:     background 0.4s;
}

.modal-close {
  font:           inherit;
  font-size:      1.1rem;
  line-height:    1;
  cursor:         pointer;
  background:     none;
  border:         none;
  color:          var(--text-muted);
  padding:        0 0.2rem;
  transition:     color 0.15s;
  flex-shrink:    0;
}

.modal-close:hover { color: var(--text-primary); }

#modal-title {
  font-size:      0.8rem;
  font-weight:    600;
  font-family:    var(--font-mono);
  color:          var(--tb-text);
}

.modal-body {
  padding: 1rem;
}

/* formulario */
#upload-form {
  display:        flex;
  flex-direction: column;
  gap:            0.85rem;
}

.form-row {
  display:        flex;
  flex-direction: column;
  gap:            0.3rem;
}

.form-row label {
  font-size:      0.75rem;
  font-family:    var(--font-mono);
  color:          var(--text-secondary);
}

.hint {
  color:      var(--text-muted);
  font-size:  0.7rem;
}

/* inputs de texto */
.form-row input[type="text"] {
  background:     var(--input-bg);
  border:         1px solid var(--input-border);
  border-radius:  2px;
  padding:        0.4rem 0.6rem;
  font:           inherit;
  font-size:      0.82rem;
  color:          var(--text-primary);
  outline:        none;
  transition:     border-color 0.15s;
}

.form-row input[type="text"]:focus {
  border-color: var(--input-focus);
}

/* zona de arrastre */
#drop-zone {
  border:         2px dashed var(--input-border);
  border-radius:  3px;
  padding:        1rem;
  text-align:     center;
  cursor:         pointer;
  display:        flex;
  flex-direction: column;
  align-items:    center;
  gap:            0.4rem;
  transition:     border-color 0.15s, background 0.15s;
}

#drop-zone:hover,
#drop-zone.drag-over {
  border-color: var(--input-focus);
  background:   var(--tag-bg);
}

#drop-icon {
  width:  32px;
  height: 32px;
  color:  var(--text-muted);
}

#drop-icon svg {
  width:  100%;
  height: 100%;
  image-rendering: pixelated;
}

#drop-label {
  font-size:      0.75rem;
  font-family:    var(--font-mono);
  color:          var(--text-muted);
}

.file-meta {
  font-size:      0.72rem;
  font-family:    var(--font-mono);
  color:          var(--text-secondary);
  min-height:     1.1em;
}

/* estado de subida */
#upload-status {
  margin-top: 0.85rem;
}

#status-msg {
  font-size:      0.75rem;
  font-family:    var(--font-mono);
  color:          var(--text-secondary);
  margin-bottom:  0.4rem;
}

#progress-bar-wrap {
  height:         3px;
  background:     var(--progress-bg);
  border-radius:  2px;
  overflow:       hidden;
}

#progress-bar {
  height:         100%;
  width:          0%;
  background:     var(--progress-fill);
  border-radius:  2px;
  transition:     width 0.3s ease;
}


/* ============================================================
   VELO DE CONFIRMACIÓN DE EDAD
   Capa semitransparente que bloquea la pantalla y pide
   confirmación antes de activar el modo +18.
   ============================================================ */
#age-veil {
  position:   fixed;
  inset:      0;
  z-index:    300;
  background: var(--veil-bg);
  backdrop-filter:         blur(6px);
  -webkit-backdrop-filter: blur(6px);
  display:    flex;
  align-items: center;
  justify-content: center;
  transition: background 0.3s;
}

#age-veil-box {
  background:     var(--veil-box-bg);
  border:         1px solid var(--veil-box-border);
  border-radius:  var(--win-radius);
  padding:        2rem 1.75rem;
  max-width:      360px;
  width:          90dvw;
  text-align:     center;
  box-shadow:     var(--win-shadow);
  display:        flex;
  flex-direction: column;
  gap:            0.85rem;
  transition:     background 0.4s, border-color 0.4s;
}

#age-veil-title {
  font-size:      0.9rem;
  font-weight:    700;
  font-family:    var(--font-mono);
  color:          var(--text-primary);
  letter-spacing: 0.04em;
}

#age-veil-desc {
  font-size:      0.8rem;
  color:          var(--text-secondary);
  line-height:    1.6;
}

#age-veil-buttons {
  display:    flex;
  gap:        0.5rem;
  justify-content: center;
  flex-wrap:  wrap;
}


/* ============================================================
   RESPONSIVE: móvil
   ============================================================ */
@media (max-width: 600px) {
  body {
    padding:    0.5rem;
    align-items: flex-start;
  }

  #window-frame {
    width:      100%;
    max-width:  100%;
    max-height: 96dvh;
    border-radius: 4px;
  }

  #file-grid {
    grid-template-columns: repeat(auto-fill, minmax(72px, 1fr));
  }

  #window-subtitle {
    display: none;
  }
}
